tenants:
{{- if $opt := . -}}
{{- if eq $opt.Tenants.Mode "static" -}}
{{- range $spec := $opt.Tenants.Authentication }}
- name: {{ $spec.TenantName }}
  id: {{ $spec.TenantID }}
  oidc:
    {{- range $secret := $opt.TenantSecrets }}
    {{- if eq $secret.TenantName $spec.TenantName -}}
    {{ if $secret.ClientID }}
    clientID: {{ $secret.ClientID }}
    {{- end -}}
    {{ if $secret.ClientSecret }}
    clientSecret: {{ $secret.ClientSecret }}
    {{- end -}}
    {{ if $secret.IssuerCAPath }}
    issuerCAPath: {{ $secret.IssuerCAPath }}
    {{- end -}}
    {{- end -}}
    {{- end }}
    issuerURL: {{ $spec.OIDC.IssuerURL }}
    {{ if $spec.OIDC.RedirectURL }}
    redirectURL: {{ $spec.OIDC.RedirectURL }}
    {{- end -}}
    {{ if $spec.OIDC.UsernameClaim }}
    usernameClaim: {{ $spec.OIDC.UsernameClaim }}
    {{- end -}}
    {{- if $spec.OIDC.GroupClaim }}
    groupClaim: {{ $spec.OIDC.GroupClaim }}
    {{- end }}
  opa:
    query: data.tempo.allow
    paths:
    - /etc/tempo-gateway/cm/rbac.yaml
    - /etc/tempo-gateway/cm/tempo-gateway.rego
{{- end -}}
{{- end -}}
{{- end -}}
